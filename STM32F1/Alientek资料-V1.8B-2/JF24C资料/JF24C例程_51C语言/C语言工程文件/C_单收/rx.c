/****************************************Copyright (c)****************************************************
**
**                                  安阳新世纪电子研究所                                                      
**
**                                  http://www.ayxsj.com
**
**--------------File Info---------------------------------------------------------------------------------
** File name:			rx.c
** Last modified Date:  2009-09-16
** Last Version:		V1.0
** Descriptions:		
*********************************************************************************************************/

#include<reg51.h>
#include<jf24c.h>

void delay_1ms(unsigned char n)
{
  unsigned char i,m;
  for(i=0;i<n;i++)
  	{
		for(m=0;m<220;m++);
	 	for(m=0;m<220;m++);
	 }
}

main()
{
 	SP = 0x60;
  	P1 = 0xFF;
   	KEY_TX=1;
  	P3 = 0xFF;

	delay_1ms(20);
  	rf_rst();       //JF24C初始化子函数
//*************************************
//**  初始化成功,LED_RX灯亮20ms
//*************************************
				LED_RX=0;
				delay_1ms(20);
				LED_RX=1;
				delay_1ms(20);
//***********************************



	while(1)
	{	
	unsigned char mm[N],i;
	unsigned char code tt[50]= {"0372-5968708/安阳新世纪电子研究所-2009/9/16"};  //将要接收的数据,校验用

	rx_data(mm);	   //接收子函数,存放在数组mm中

//**************************************************
//** 收到数据,测试灯 LED_TX 亮20ms
//**************************************************
			delay_1ms(50);
			LED_TX=0;
			delay_1ms(50);
			LED_TX=1;
//**************************************************

	for(i=0;i<N;i++)
			{
			 if(mm[i]!=tt[i])
			  {	
			    i=0;
			    break;		
			  }  
	   		}


	if(i==N)
			{
//**************************************************
//** 接收和发送数据完全吻合,测试灯亮20ms
//**************************************************
			LED_RX=0;
			delay_1ms(20);
			LED_RX=1;
			delay_1ms(20);	   
			}				
	 }
}
/*********************************************************************************************************
  END FILE
*********************************************************************************************************/